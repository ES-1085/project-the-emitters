```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(gganimate)
library(rmapshaper)
library(transformr)
library("rnaturalearth")
library("rnaturalearthdata")
library("gganimate")
library(gifski)
library(png)
library(visdat)
library(naniar)
library("tidyr")
```

```{r}
owid_co2_data<- read_csv("../data/owid-co2-data.csv")
```
```{r}
CO2_data <- owid_co2_data
```

```{r}
Our_co2_dataset <- owid_co2_data %>% 
  select("country", "year", "population", "co2", "co2_per_capita", "iso_code", "gdp")
```

```{
```


```{r}
library("rnaturalearth")
library("rnaturalearthdata")

world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)
```
```{r}
colnames(world)[10] ="iso_code"
```

```{r}
world_continents <- world %>%
  select(iso_code, continent)
```

```{r}
CO2_continents_data <- Our_co2_dataset %>%
  full_join(world_continents)
```
```{r}
CO2_continents_data %>%
  filter(is.na(continent) == TRUE) %>%
  distinct(country)
```
```{r}
Only_Countries_CO2 <- CO2_continents_data %>%
  drop_na(continent)
  
```


```{r}
Only_Countries_CO2 %>%
  filter(year == 1990,
         iso_code != "ATA") %>%
  ggplot(aes(x = gdp,
        y = co2)) +
  geom_miss_point(alpha = 0.5) + 
  facet_wrap(~continent, ncol = 1) 
  #labs(xlim = c(0, 10000000000000))
  # scale_x_discrete(labels=c(0.0e+00 == 0, 2.5e+12 == "2.5 trillion", 5.0e+12 == "5 trillion", 7.5e+12 == "7.5 trillion"))
```


```{r}
Only_Countries_CO2 %>%
  filter(year >= 1950,
          year <= 2018,
         iso_code != "ATA") %>%
  ggplot(aes(x = gdp,
        y = co2)) +
  geom_miss_point(alpha = 0.5) + 
  facet_wrap(~continent) +
  labs(title = 'Year: {closest_state}') +
  transition_states(states = year, transition_length = 0.2)
```
```{r}
Only_Countries_CO2 %>%
  filter(year >= 1950,
          year <= 2018,
         iso_code != "ATA") %>%
  ggplot(aes(x = gdp,
        y = co2)) +
  xlim(0, 2000000000000)
  geom_miss_point(alpha = 0.5) + 
  facet_wrap(~continent) +
  labs(title = 'Year: {closest_state}') +
  transition_states(states = year, transition_length = 0.2)
```

